@model PizzaKing.ViewModels.PizzaBuilderViewModel
@{
    ViewData["Title"] = "Создать пиццу";
}

<div class="container mt-4">
    <h2>@ViewData["Title"]</h2>

    <form asp-action="Build" method="post">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>

        <div class="row">
            <div class="col-md-4">
                <h4>Корж</h4>
                @foreach (var crust in Model.Crusts)
                {
                    <div class="card mb-2 p-2">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="SelectedCrustId" id="crust_@crust.Id" value="@crust.Id" @(crust.Id == Model.SelectedCrustId ? "checked" : "") />
                            <label class="form-check-label" for="crust_@crust.Id">
                                <strong>@crust.Name</strong> — @String.Format("{0:C}", crust.Price)
                            </label>
                        </div>
                        @if (!string.IsNullOrEmpty(crust.ImagePath))
                        {
                            <div class="mt-1">
                                <img src="@crust.ImagePath" alt="@crust.Name" style="max-width:100%;height:64px;object-fit:contain" />
                            </div>
                        }
                    </div>
                }
            </div>

            <div class="col-md-4">
                <h4>Соус</h4>
                @foreach (var sauce in Model.Sauces)
                {
                    <div class="card mb-2 p-2">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="SelectedSauceId" id="sauce_@sauce.Id" value="@sauce.Id" @(sauce.Id == Model.SelectedSauceId ? "checked" : "") />
                            <label class="form-check-label" for="sauce_@sauce.Id">
                                <strong>@sauce.Name</strong> — @String.Format("{0:C}", sauce.Price)
                            </label>
                        </div>
                        @if (!string.IsNullOrEmpty(sauce.ImagePath))
                        {
                            <div class="mt-1">
                                <img src="@sauce.ImagePath" alt="@sauce.Name" style="max-width:100%;height:64px;object-fit:contain" />
                            </div>
                        }
                    </div>
                }
            </div>

            <div class="col-md-4">
                <h4>Топпинги</h4>
                @foreach (var top in Model.Toppings)
                {
                    var isChecked = (Model.SelectedToppingIds != null && Model.SelectedToppingIds.Contains(top.Id)) ? "checked" : (top.IsDefault ? "checked" : "");
                    <div class="card mb-2 p-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="SelectedToppingIds" id="top_@top.Id" value="@top.Id" @isChecked />
                            <label class="form-check-label" for="top_@top.Id">
                                <strong>@top.Name</strong> — @String.Format("{0:C}", top.Price)
                            </label>
                        </div>
                        @if (!string.IsNullOrEmpty(top.ImagePath))
                        {
                            <div class="mt-1">
                                <img src="@top.ImagePath" alt="@top.Name" style="max-width:100%;height:64px;object-fit:contain" />
                            </div>
                        }
                    </div>
                }
            </div>
        </div>

        <div class="mt-3">
            <button type="submit" class="btn btn-primary">Посчитать и показать итог</button>
        </div>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
